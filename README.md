# ___YMaps Parser___
<a id='readme-top'></a>
Парсер данных предназначен для сбора информации о предприятиях.

## Безопасность и соблюдение правил

#### **Данный инструмент предназначен для сбора открытой информации в образовательных и исследовательских целях.** 

### Рекомендуется:

- Ознакомиться с условиями использования

- Использовать инструмент ответственно и в соответствии с законодательством

## Возможности

- **Два режима парсинга**: по ключевому слову и городу или по прямой ссылке
- **Извлечение данных**: URL компании, название, категория, телефон, сайт
- **Экспорт в Excel**: автоматическое сохранение результатов в формате XLSX
- **Графический интерфейс**: интуитивно понятное приложение с поддержкой темной и светлой темы
- **Асинхронная обработка**: высокая производительность без блокировки интерфейса

## Требования

- Python 3.11 или выше
- Подключение к интернету

## Установка

### Способ 1: Запуск через Python

1. Клонируйте репозиторий или скачайте исходный код
2. Скачайте Python с официального сайта ([ссылка на сайт](https://www.python.org/)) или запустите python_installer_1.bat
3. Установите зависимости:

- `pip install playwright openpyxl deep_translator sv-ttk asyncio`
- `playwright install chromium`
- Откройте файл `Main_YMaps.py`

### В функции main() настройте параметры:

- **keyword**: ключевое слово для поиска
- **city**: город для парсинга
- **max_num_firm**: количество компаний для обработки

### -Запустите файл-

### Способ 2: Графический интерфейс

- Запустите файл `gui_main.py`
- Откроется приложение **YMapsParser**:
- Введите ключевое слово и город в "Параметры парсинга"
- Укажите количество фирм в "Дополнительных параметрах"
- Нажмите "Запустить парсинг"

При необходимости используйте режим "Парсинг по URL" для работы с прямыми ссылками формата:

* https<span></span>://yandex.ru/maps/1/a/search/Омск,Рестораны

### Способ 3: Исполняемый файл

- Запустите `python_installer_1.bat`
- После обработки файла появится установщик Python
- Отметьте галочкой "**Use admin privileges when installing py.exe**"
- Отметьте галочкой "**Add python.exe to PATH**"
- Нажмите на кнопку "**Install Now**"
- После загрузки появится "**Setup was successful**", нажмите на кнопку "**Close**"
- Запустите `ymapsparser_installer_2.bat` **от имени администратора**
- Дождитесь установки зависимостей и сборки EXE-файла
- На рабочем столе появится ярлык **YMaps Parser**
- Используйте графический интерфейс как описано в **способе 2**(без запуска gui_main.py)

### Использование
#### Парсер по ключу

- *При заходе в приложение стоит автоматичски
- Выберите режим "Парсер по ключу"
- Введите ключевое слово (например, "Рестораны")
- Укажите город (например, "Москва")
- Задайте количество компаний для обработки
- Нажмите "Запустить парсинг"

#### Парсер по URL
- Выберите режим "Парсер по URL"
- Вставьте ссылку на страницу поиска
- Укажите количество компаний для обработки
- Нажмите "Запустить парсинг"

### Выходные данные

#### Результаты сохраняются в файл *ymaps_parse_results/ymaps_data.xlsx** со следующими колонками:

| Колонка   | Описание               |
|-----------|------------------------|
| URL       | Ссылка на страницу компании |
| Название  | Название предприятия   |
| Категория | Категория деятельности |
| Телефон   | Контактный телефон     |
| Сайт      | Веб-сайт компании      |

### Особенности работы

- Случайные задержки: для имитации человеческого поведения
- Ротация User-Agent: обход ограничений на автоматизацию
- Обработка ошибок: устойчивость к временным сбоям сети
- Логирование: подробный журнал выполнения операций


## Устранение неполадок
#### Если парсер не работает:

- Проверьте подключение к интернету
- Убедитесь, что установлены все зависимости
- Проверьте корректность введенных параметров
- Если загрузка `python_installer_1.bat` или `ymapsparser_installer_2.bat` остановилась и не двигается какое-то время, нажмите **Enter**

Для режима по ключу: используйте режим по URL с предварительно сгенерированной ссылкой или можете сгенерировать с помощью кнопки **"Сгенерировать URL"**

### Поддержка
#### При возникновении проблем создавайте issue в репозитории проекта. Указывайте:

- Описание проблемы
- Шаги для воспроизведения
- Скриншоты или логи ошибок
- Версию Python и установленные пакеты  

**Важно:** Данный инструмент предназначен исключительно для образовательных и исследовательских целей. Используйте его ответственно и в рамках действующего законодательства. Разработчик не несет ответственности за неправомерное использование программы.
<p align='right'>
  <a href='#readme-top'>Back to top</a>
</p>